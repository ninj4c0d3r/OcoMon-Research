# OcoMon < 4.0.1  - File Inclusion allow Remote Code Execution

# Description

The vulnerability allows an authenticated user to change the language setting by passing a valid file path, the code will include the file and in some environments will execute malicious code.

## Bug - 1

The vulnerability occurs because the function **TRANS** not validate and not sanitize user data entry.

![image](https://i.imgur.com/4cXmiDk.png)

# PoC

Through Log Poisoining it was possible to obtain RCE in the application

- Do log poisoning by inserting malicious code in PHP;

![image](https://i.imgur.com/en34Kvb.png)

- Logs:

![image](https://i.imgur.com/pVp7z0R.png)

- When changing the user's language, intercept the request and in the "**lang**" parameter add using **path traversal** the directory of the log that was poisoned;

![image](https://i.imgur.com/6xM1PvC.png)

- After saving the settings, when the user opens the application, the Log file will be imported and the malicious php code will be executed;

![image](https://i.imgur.com/pZyG2jJ.png)


## FIX

https://ocomonphp.sourceforge.io/downloads/
